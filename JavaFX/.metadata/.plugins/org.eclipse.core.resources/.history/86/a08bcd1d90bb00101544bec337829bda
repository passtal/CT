package application;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Random;

import javafx.animation.KeyFrame;
import javafx.animation.Timeline;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.util.Duration;

public class MainController {

    @FXML
    private Button button;

    @FXML
    private ImageView img;

    @FXML
    private Label menu;
    
    // 메뉴 리스트
    private static List<Menu> MENU_LIST;
    
    // 타이머 1 - 0.05초마다 메뉴를 변경하는 타이
    private Timeline rotate = null;
    
    // 타이머 2 - 3초 뒤 랜덤메뉴를 고르는 타이머
    private Timeline stop = null;

    /**
     * FXML이 로딩될 때 초기화하는 메소드
     * 데이터 초기화
     * 이벤트 등록
     */
    
    @FXML
    public void initialize() {
    	
    	// 데이터 초기화
    	initData();
   	 
    	// 타이머 세팅
    	initTimer();
    }
    
    /**
     * 데이터 초기화
     */
    
    void initData() {
    	MENU_LIST = new ArrayList<Menu>();
    	List<String> nameList
    	= Arrays.asList("국밥", "라면", "볶음밥", "부대찌개", "분식", "경양식돈까스", "일식돈까스",
    					"빵", "샌드위치", "샐러드(포케)", "쌈밥", "우동소바", "육회(비빔밥)", "짜장면",
    					"짬뽕", "초밥", "카레라이스", "파스타(양식)", "피자", "햄버거");
    	
    	List<String> imgList
    	= Arrays.asList("국밥.jpg", "라면.jpg", "볶음밥.jpg", "부대찌개.jpg", "분식.jpg",
    					"경양식돈까스.jpg", "일식돈까스.jpg", "빵.jpg", "샌드위치.jpg",
    					"샐러드(포케).jpg", "쌈밥.jpg", "우동소바.jpg", "육회(비빔밥).jpg",
    					"짜장면.jpg", "짬뽕.jpg", "초밥.jpg", "카레라이스.jpg", "파스타(양식).jpg",
    					"피자.jpg", "햄버거.jpg");
    	
    	for (int i = 0; i < 20; i++) {
    		String name = nameList.get(i);
			String img = imgList.get(i);
			MENU_LIST.add(new Menu(name, img));
		}
    }
    
    /**
     * 타이머 세팅
     */
    
    public void initTimer() {
    	// 0.05초 마다 랜덤 타이머
    	rotate = new Timeline(
    		new KeyFrame( Duration.millis(50), e ->  {
    			// 랜덤 메뉴 세팅
    			// TODO : setMenu()
    			setMenu();
    		})
    	);
    	
    	rotate.setCycleCount(Timeline.INDEFINITE);
    	
    	// 3초 뒤에 메뉴 고르는 타이머
    	stop = new Timeline(
    		new KeyFrame( Duration.millis(3000), e -> rotate.stop() )	
    	);
    	stop.setCycleCount(1);
    }
    
    /**
     * 랜덤 메뉴 뽑기
     */
    
    public void setMenu() {
    	
    	// 20개의 메뉴 요소들 중, 랜덤으로 하나 선택
    	Random random = new Random();
    	int index = random.nextInt(20);
    	Menu randomMenu = MENU_LIST.get(index);
    	String menuName = randomMenu.getMenu();
    	String menuImg = randomMenu.getImg();
    	
    	// 메뉴명 라벨에 지정
    	menu.setText(menuName);
    	
    	// 메뉴 이미지 지정
    	String filePath = getClass().getResource("/img/" + menuImg).toExternalForm();
    	img.setImage(new Image(filePath));
    }
    
    
    @FXML
    void random(ActionEvent event) {
    	
    	

    }

}
